# cuda高性能编程

> 记录下学习cuda并行编程的笔记，主要书籍是《GPU高性能编程》《cuda并行程序设计》，书籍比较短，因此只要一个笔记来记录所有的内容，包括示例程序和文字。

## 1. cuda是什么

   cuda实际上是实现**并行计算**的一种程序形式。当前人们对计算力的需求在急速增长，不管是气象预测、地震预告，还是游戏渲染和自动驾驶，**CPU**的处理速度已经远远达不到人们的要求。但是近年来集成电路元器件中存在的各种严重限制，导致**CPU**的速度提升越来越困难，研究人员和制造商开始寻求其他的方式。

- 在2000年前，GPU的主要目标是通过可编程单元为屏幕上的**每个像素计算出对应颜色值**，进行像素着色。输入包括**颜色和纹理坐标**。研究人员发现可以输入其实可以是任意数据。
- **GPU**有很高的吞吐量，输入可以是任意值，那么可不可以利用来加速其他运算呢？只需要抽象成渲染任务，拿到相应输出就好了。
- 限制很多，出现**cuda**来进一步抽象，方便程序员们使用。

### cuda

- 架构
  - 统一着色流水线
  - 图形计算＋通用计算
- 应用
  - 医学图像：3d成像，保证快速出图
  - 计算流体动力学
  - 环境科学

## 2.第一段代码

最经典的“Hello, World!”示例:

```cpp
#include<stdio.h>

__global__ void kernel(void) {
}

int main(void) {
    kernel<<<1,1>>>();
    printf( "Hello, World!\n ");
    return 0;
}
```

- \__global__修饰符告诉编译器，kernel函数将被编译为在**设备**运行,而不是**主机**
- kernel空函数的调用带了修饰符<<<1,1>>>
  - 设计到主机跟设备之间的交互，上面修饰符就是完成这样的功能
  - 

